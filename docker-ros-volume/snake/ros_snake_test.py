#!/usr/bin/env python3

import os

# Direct kinematics
import kinpy as kp

# Inverse kinematics through optimization
import numpy as np
import time
from math import cos, sin
from scipy.optimize import minimize
import pandas as pd

# ROS libraries
import rospy
from sensor_msgs.msg import JointState
from trac_ik_python.trac_ik import IK


class RobotKinematics:
    """Calculate direct and inverse kinematics through different methods"""

    def __init__(self, urdf_mode_path):
        urdf = open("/root/catkin_ws/src/snake/"+urdf_mode_path).read()        
        urdf = urdf.replace('encoding="utf-8"', '').replace('encoding=\'utf-8\'', '')
        self.chain = kp.build_chain_from_urdf(urdf)
        self.njoints = len( self.chain.get_joint_parameter_names() )
        self.end_link = "end_effector" # "link{}".format(self.njoints)
        self.ik_solver = IK("link0", self.end_link, urdf_string=urdf)

    def angle_to_positions(self, joint_angles):
        # check input
        assert len(joint_angles) == self.njoints, "Model needs exactly {} angles ({} currently given)".format(self.njoints, len(joint_angles))
        # from angles construct a `joint state` structure
        joint_state = {}
        for i in range(0, len(joint_angles)):
            joint_state["joint{}".format(i)] = joint_angles[i]
        # apply direct kinematics
        all_link_positions = self.chain.forward_kinematics(joint_state)
        # get positions
        manipulator_positions = []
        for i in range(0, self.njoints+1):
            joint_name = "link{}".format(i)
            manipulator_positions.append(all_link_positions[joint_name].pos)
        manipulator_positions.append(all_link_positions[self.end_link].pos)
        return manipulator_positions

    def run_trac_ik(self, point):
        initial_state = np.array(self.njoints * [0.0]).astype(float)
        return self.ik_solver.get_ik(initial_state, point[0], point[1], point[2], 0, 0, 0, 1.0, 1e-8, 1e-8, 1e-8)

class Tester:

    METHODS = [ 'SLSQP', 'COBYLA' ] # [ 'L-BFGS-B', 'TNC', 'SLSQP', 'COBYLA' ]

    MODELS = [ "modello_8.urdf", "modello_16.urdf", "modello_24.urdf", "modello_32.urdf", "modello_40.urdf", "modello_48.urdf" ]

    COLUMNS = [ 'model', 'method', 'main_point_given', 'main_point_inferred', 'main_point_error (%)',
                'middle_point_given', 'middle_point_error (%)', 'time']

    NPOINTS = 200

    @staticmethod
    def pick_a_point(radius):
        r = radius * np.sqrt(np.random.uniform())
        theta = np.random.uniform() * np.pi/2
        x, y = r*cos(theta), r*sin(theta)
        xy2 = x**2 + y**2
        z = np.sqrt(radius**2 - xy2)
        z = np.random.uniform() * z
        return np.array([x, y, z])

    def __init__(self):
        # generate empty dataframe
        self.df = pd.DataFrame(columns=self.COLUMNS)
        # generate point set
        self.point_collection = {}
        # TODO ADD POINTS MANUALLY
        self.point_collection["modello_8.urdf"] = pd.DataFrame([
            np.array([2.37514422e-01, 1.75318047e-01, 8.79827700e-05]),
            np.array([0.25652159, 0.11638577, 0.00763702]),
            np.array([0.09671804, 0.20649288, 0.17601399]),
            np.array([0.01112268, 0.26449784, 0.01062672]),
            np.array([0.17420445, 0.01226583, 0.18098153]),
            np.array([0.01504667, 0.14152006, 0.24102454]),
            np.array([0.11669902, 0.26455085, 0.02277885]),
            np.array([0.23615305, 0.03707896, 0.12334066]),
            np.array([0.07953055, 0.02692259, 0.01938544]),
            np.array([0.14624886, 0.21105578, 0.0831185 ]),
            np.array([0.08720389, 0.21350301, 0.14727423]),
            np.array([0.10075683, 0.11471437, 0.03835242]),
            np.array([0.01237427, 0.15703834, 0.10149176]),
            np.array([0.11921152, 0.19656862, 0.08597295]),
            np.array([0.02887176, 0.16433687, 0.11147905]),
            np.array([0.14832802, 0.2465468 , 0.00264292]),
            np.array([0.2753068 , 0.04874978, 0.09811605]),
            np.array([0.25321674, 0.13259786, 0.06393366]),
            np.array([0.10020872, 0.1860726 , 0.14670399]),
            np.array([0.11666952, 0.04052128, 0.09745601]),
            np.array([0.05332094, 0.02079516, 0.05844204]),
            np.array([0.17438535, 0.0556921 , 0.14232408]),
            np.array([0.01313739, 0.06357664, 0.14278421]),
            np.array([0.17843532, 0.13981392, 0.05446916]),
            np.array([0.10114232, 0.01825892, 0.09988693]),
            np.array([0.18796507, 0.05773   , 0.22052731]),
            np.array([0.04345235, 0.09183371, 0.05428093]),
            np.array([0.05679302, 0.13713956, 0.019825  ]),
            np.array([0.08004566, 0.13633952, 0.25302637]),
            np.array([0.02535718, 0.2922128 , 0.0567065 ]),
            np.array([0.22373843, 0.15191577, 0.0858164 ]),
            np.array([0.08374444, 0.25031863, 0.14189766]),
            np.array([0.18808809, 0.18930925, 0.12510525]),
            np.array([0.03408052, 0.27441484, 0.05233312]),
            np.array([0.19613232, 0.04284586, 0.12367665]),
            np.array([0.20320421, 0.04266641, 0.1993641 ]),
            np.array([0.24389368, 0.13319386, 0.02699312]),
            np.array([0.04129547, 0.03600729, 0.06515278]),
            np.array([0.08606209, 0.19852251, 0.11801199]),
            np.array([0.00747611, 0.17457072, 0.14008985]),
            np.array([0.19282719, 0.01770288, 0.18522131]),
            np.array([0.07364639, 0.11025966, 0.04953408]),
            np.array([0.14535961, 0.03895909, 0.21660248]),
            np.array([0.21860254, 0.05835818, 0.06201362]),
            np.array([0.13461656, 0.15096643, 0.19794959]),
            np.array([0.11190257, 0.16166295, 0.08423375]),
            np.array([0.18690545, 0.12689619, 0.0170301 ]),
            np.array([0.04902981, 0.20947294, 0.02463997]),
            np.array([0.21328537, 0.18485473, 0.04585867]),
            np.array([0.12127272, 0.0367294 , 0.09885132]),
            np.array([0.08638841, 0.20497793, 0.15020962]),
            np.array([0.01979883, 0.14515207, 0.01884611]),
            np.array([0.19133229, 0.10187594, 0.14528599]),
            np.array([0.28560321, 0.04061856, 0.0617445 ]),
            np.array([0.11697782, 0.11848744, 0.06407644]),
            np.array([0.26078256, 0.03537293, 0.02568431]),
            np.array([0.21124183, 0.1438569 , 0.1548743 ]),
            np.array([0.08385408, 0.00406215, 0.08639058]),
            np.array([0.19061315, 0.11715732, 0.12170034]),
            np.array([0.1021331 , 0.09550256, 0.00104921]),
            np.array([0.188705  , 0.15890492, 0.02309603]),
            np.array([0.23045104, 0.04096036, 0.12389335]),
            np.array([0.24636485, 0.06364368, 0.09018118]),
            np.array([0.23903178, 0.10597289, 0.0961581 ]),
            np.array([0.00650322, 0.24060141, 0.14041773]),
            np.array([0.08812856, 0.12341024, 0.1979155 ]),
            np.array([0.12768243, 0.08329134, 0.00664943]),
            np.array([0.09432808, 0.12716925, 0.16664362]),
            np.array([0.03004203, 0.00353126, 0.12497661]),
            np.array([0.11338663, 0.10912901, 0.10801514]),
            np.array([0.16407823, 0.20884478, 0.07667875]),
            np.array([0.01465951, 0.25266423, 0.11015682]),
            np.array([0.23808763, 0.10079928, 0.02894712]),
            np.array([0.22055993, 0.14138528, 0.04048226]),
            np.array([0.27402581, 0.0348612 , 0.10680049]),
            np.array([0.01492702, 0.11778405, 0.16422393]),
            np.array([0.09709939, 0.15723251, 0.02491817]),
            np.array([0.03109772, 0.05781324, 0.13319437]),
            np.array([0.08997778, 0.08188593, 0.07961698]),
            np.array([0.17887873, 0.21295485, 0.04139516]),
            np.array([0.01614252, 0.22145846, 0.17920186]),
            np.array([0.2383463 , 0.0748208 , 0.08785658]),
            np.array([0.15383377, 0.14244447, 0.10746095]),
            np.array([0.04010639, 0.18103592, 0.0130486 ]),
            np.array([0.06257228, 0.29220111, 0.00125325]),
            np.array([0.06414304, 0.254131  , 0.09209347]),
            np.array([0.09284317, 0.08958574, 0.15799134]),
            np.array([0.12961795, 0.03054528, 0.07497151]),
            np.array([0.04067262, 0.15809277, 0.06113907]),
            np.array([0.04239182, 0.16211177, 0.14733439]),
            np.array([0.11380315, 0.04305786, 0.17071568]),
            np.array([0.06816976, 0.00179346, 0.04631972]),
            np.array([0.10802647, 0.02217225, 0.00599246]),
            np.array([0.00586853, 0.24533565, 0.16347356]),
            np.array([0.00123726, 0.23259682, 0.1058752 ]),
            np.array([0.27975545, 0.04108462, 0.02471266]),
            np.array([0.0998797 , 0.10741366, 0.25286662]),
            np.array([0.04842353, 0.16110137, 0.16233107]),
            np.array([0.0509332 , 0.10166057, 0.27372989]),
            np.array([0.19264889, 0.16616232, 0.06180992]),
            np.array([0.19847065, 0.14583715, 0.13275077]),
            np.array([0.22597414, 0.17910547, 0.05840158]),
            np.array([0.2120834 , 0.16434841, 0.02007916]),
            np.array([0.04329565, 0.2809441 , 0.0791985 ]),
            np.array([0.09892367, 0.13347568, 0.23411521]),
            np.array([0.18921646, 0.0254934 , 0.22418247]),
            np.array([0.10654903, 0.02513713, 0.21391664]),
            np.array([0.11384655, 0.19330981, 0.05382412]),
            np.array([0.25966741, 0.00231558, 0.10821897]),
            np.array([0.08849618, 0.10273877, 0.01463384]),
            np.array([0.13255496, 0.20737058, 0.02792361]),
            np.array([0.14157651, 0.18739985, 0.13740436]),
            np.array([0.03050341, 0.15691038, 0.19564674]),
            np.array([0.26002477, 0.00841683, 0.13617243]),
            np.array([0.22238969, 0.18576985, 0.00349597]),
            np.array([0.20008272, 0.21253078, 0.00570972]),
            np.array([0.17380425, 0.06472133, 0.11826108]),
            np.array([0.03873955, 0.19725418, 0.04720055]),
            np.array([0.05586554, 0.20814951, 0.13697571]),
            np.array([0.04565449, 0.01472906, 0.0852556 ]),
            np.array([0.04293809, 0.29136752, 0.00135179]),
            np.array([0.03821408, 0.06936401, 0.02595715]),
            np.array([0.00123967, 0.23923315, 0.11170531]),
            np.array([0.01950993, 0.00255121, 0.13999153]),
            np.array([0.2751632 , 0.07556494, 0.06250738]),
            np.array([0.20637726, 0.0648869 , 0.13379492]),
            np.array([0.17914648, 0.04802295, 0.16063325]),
            np.array([0.11297754, 0.11670623, 0.10206259]),
            np.array([0.06619797, 0.20700306, 0.01395635]),
            np.array([0.13834996, 0.14780951, 0.16336846]),
            np.array([0.18523555, 0.23541688, 0.00952733]),
            np.array([0.08522869, 0.09505661, 0.06516662]),
            np.array([0.23612589, 0.14303088, 0.01600968]),
            np.array([0.06824194, 0.20458077, 0.0379285 ]),
            np.array([0.12821887, 0.03520333, 0.0048195 ]),
            np.array([0.03317   , 0.05212797, 0.05883483]),
            np.array([0.06194256, 0.25043402, 0.12733343]),
            np.array([0.23800564, 0.13477116, 0.07588774]),
            np.array([0.09093939, 0.27187176, 0.06255886]),
            np.array([0.08641943, 0.11744407, 0.16648038]),
            np.array([0.26746928, 0.08608354, 0.04808151]),
            np.array([0.20087507, 0.08975431, 0.0919082 ]),
            np.array([0.1715015 , 0.16669419, 0.10888851]),
            np.array([0.05985321, 0.20303498, 0.16396186]),
            np.array([0.19127081, 0.21700355, 0.03552037]),
            np.array([0.14328193, 0.09473562, 0.12746634]),
            np.array([0.06652446, 0.09530574, 0.20289727]),
            np.array([0.00212435, 0.27870466, 0.09625596]),
            np.array([0.00133912, 0.21233167, 0.14873419]),
            np.array([0.17005066, 0.13807191, 0.00483463]),
            np.array([0.1234432 , 0.12187643, 0.18956935]),
            np.array([0.0924941 , 0.26346268, 0.05836817]),
            np.array([0.16742412, 0.11465058, 0.04540342]),
            np.array([0.23026988, 0.11315321, 0.03623322]),
            np.array([0.19512978, 0.07946028, 0.14053002]),
            np.array([0.13386035, 0.04788852, 0.20586109]),
            np.array([0.13138548, 0.03410095, 0.17721465]),
            np.array([0.10302931, 0.1454456 , 0.1888906 ]),
            np.array([0.18463277, 0.23561722, 0.0143786 ]),
            np.array([0.17217613, 0.23355376, 0.07607669]),
            np.array([0.28725304, 0.04629072, 0.01303354]),
            np.array([0.14858921, 0.18659913, 0.12354305]),
            np.array([0.09153606, 0.01814574, 0.00409722]),
            np.array([0.28086746, 0.0948185 , 0.00180343]),
            np.array([0.0677463 , 0.23210142, 0.01130163]),
            np.array([0.05593071, 0.10867454, 0.07258079]),
            np.array([0.13415668, 0.20083854, 0.06185348]),
            np.array([0.20395251, 0.17296762, 0.0223744 ]),
            np.array([0.03322968, 0.10743056, 0.00058808]),
            np.array([0.1595255 , 0.06357125, 0.05098563]),
            np.array([0.16441605, 0.10435734, 0.17472137]),
            np.array([0.06720247, 0.03772779, 0.20233528]),
            np.array([0.12498108, 0.12780832, 0.00648564]),
            np.array([0.07683371, 0.26811166, 0.07794433]),
            np.array([0.09201309, 0.24297988, 0.09301611]),
            np.array([0.2218774 , 0.04549159, 0.06453003]),
            np.array([0.02568134, 0.16337871, 0.23898173]),
            np.array([0.0452318 , 0.23499234, 0.11886153]),
            np.array([0.04722691, 0.09307442, 0.12942773]),
            np.array([0.14603967, 0.10650362, 0.18066945]),
            np.array([0.24876895, 0.14381045, 0.04887364]),
            np.array([0.19449685, 0.07176904, 0.13295132]),
            np.array([0.12408233, 0.11348128, 0.01442846]),
            np.array([0.00437644, 0.12223801, 0.18381361]),
            np.array([0.12963344, 0.07217126, 0.23501474]),
            np.array([0.19668233, 0.09122984, 0.10652394]),
            np.array([0.0433664 , 0.1419562 , 0.25177607]),
            np.array([0.27352068, 0.08111089, 0.02902535]),
            np.array([0.15750757, 0.00659976, 0.12876866]),
            np.array([0.04176833, 0.24964858, 0.04268907]),
            np.array([0.22870738, 0.08550192, 0.06464655]),
            np.array([0.03385241, 0.25092405, 0.1254248 ]),
            np.array([0.1028429 , 0.0663055 , 0.15456477]),
            np.array([0.09165711, 0.04972029, 0.17863305]),
            np.array([0.16914452, 0.06846731, 0.17883501]),
            np.array([0.21382006, 0.17122172, 0.11393659]),
            np.array([0.14275804, 0.07466466, 0.00939601]),
            np.array([0.29157373, 0.02562523, 0.04132319]),
            np.array([0.20042751, 0.10542359, 0.04852195]),
            np.array([0.04791158, 0.07778994, 0.06039454])
        ])
        self.point_collection["modello_16.urdf"] = pd.DataFrame([
            np.array([2.37514422e-01, 1.75318047e-01, 8.79827700e-05]),
            np.array([0.25652159, 0.11638577, 0.00763702]),
            np.array([0.09671804, 0.20649288, 0.17601399]),
            np.array([0.01112268, 0.26449784, 0.01062672]),
            np.array([0.17420445, 0.01226583, 0.18098153]),
            np.array([0.01504667, 0.14152006, 0.24102454]),
            np.array([0.11669902, 0.26455085, 0.02277885]),
            np.array([0.23615305, 0.03707896, 0.12334066]),
            np.array([0.07953055, 0.02692259, 0.01938544]),
            np.array([0.14624886, 0.21105578, 0.0831185 ]),
            np.array([0.08720389, 0.21350301, 0.14727423]),
            np.array([0.10075683, 0.11471437, 0.03835242]),
            np.array([0.01237427, 0.15703834, 0.10149176]),
            np.array([0.11921152, 0.19656862, 0.08597295]),
            np.array([0.02887176, 0.16433687, 0.11147905]),
            np.array([0.14832802, 0.2465468 , 0.00264292]),
            np.array([0.2753068 , 0.04874978, 0.09811605]),
            np.array([0.25321674, 0.13259786, 0.06393366]),
            np.array([0.10020872, 0.1860726 , 0.14670399]),
            np.array([0.11666952, 0.04052128, 0.09745601]),
            np.array([0.05332094, 0.02079516, 0.05844204]),
            np.array([0.17438535, 0.0556921 , 0.14232408]),
            np.array([0.01313739, 0.06357664, 0.14278421]),
            np.array([0.17843532, 0.13981392, 0.05446916]),
            np.array([0.10114232, 0.01825892, 0.09988693]),
            np.array([0.18796507, 0.05773   , 0.22052731]),
            np.array([0.04345235, 0.09183371, 0.05428093]),
            np.array([0.05679302, 0.13713956, 0.019825  ]),
            np.array([0.08004566, 0.13633952, 0.25302637]),
            np.array([0.02535718, 0.2922128 , 0.0567065 ]),
            np.array([0.22373843, 0.15191577, 0.0858164 ]),
            np.array([0.08374444, 0.25031863, 0.14189766]),
            np.array([0.18808809, 0.18930925, 0.12510525]),
            np.array([0.03408052, 0.27441484, 0.05233312]),
            np.array([0.19613232, 0.04284586, 0.12367665]),
            np.array([0.20320421, 0.04266641, 0.1993641 ]),
            np.array([0.24389368, 0.13319386, 0.02699312]),
            np.array([0.04129547, 0.03600729, 0.06515278]),
            np.array([0.08606209, 0.19852251, 0.11801199]),
            np.array([0.00747611, 0.17457072, 0.14008985]),
            np.array([0.19282719, 0.01770288, 0.18522131]),
            np.array([0.07364639, 0.11025966, 0.04953408]),
            np.array([0.14535961, 0.03895909, 0.21660248]),
            np.array([0.21860254, 0.05835818, 0.06201362]),
            np.array([0.13461656, 0.15096643, 0.19794959]),
            np.array([0.11190257, 0.16166295, 0.08423375]),
            np.array([0.18690545, 0.12689619, 0.0170301 ]),
            np.array([0.04902981, 0.20947294, 0.02463997]),
            np.array([0.21328537, 0.18485473, 0.04585867]),
            np.array([0.12127272, 0.0367294 , 0.09885132]),
            np.array([0.08638841, 0.20497793, 0.15020962]),
            np.array([0.01979883, 0.14515207, 0.01884611]),
            np.array([0.19133229, 0.10187594, 0.14528599]),
            np.array([0.28560321, 0.04061856, 0.0617445 ]),
            np.array([0.11697782, 0.11848744, 0.06407644]),
            np.array([0.26078256, 0.03537293, 0.02568431]),
            np.array([0.21124183, 0.1438569 , 0.1548743 ]),
            np.array([0.08385408, 0.00406215, 0.08639058]),
            np.array([0.19061315, 0.11715732, 0.12170034]),
            np.array([0.1021331 , 0.09550256, 0.00104921]),
            np.array([0.188705  , 0.15890492, 0.02309603]),
            np.array([0.23045104, 0.04096036, 0.12389335]),
            np.array([0.24636485, 0.06364368, 0.09018118]),
            np.array([0.23903178, 0.10597289, 0.0961581 ]),
            np.array([0.00650322, 0.24060141, 0.14041773]),
            np.array([0.08812856, 0.12341024, 0.1979155 ]),
            np.array([0.12768243, 0.08329134, 0.00664943]),
            np.array([0.09432808, 0.12716925, 0.16664362]),
            np.array([0.03004203, 0.00353126, 0.12497661]),
            np.array([0.11338663, 0.10912901, 0.10801514]),
            np.array([0.16407823, 0.20884478, 0.07667875]),
            np.array([0.01465951, 0.25266423, 0.11015682]),
            np.array([0.23808763, 0.10079928, 0.02894712]),
            np.array([0.22055993, 0.14138528, 0.04048226]),
            np.array([0.27402581, 0.0348612 , 0.10680049]),
            np.array([0.01492702, 0.11778405, 0.16422393]),
            np.array([0.09709939, 0.15723251, 0.02491817]),
            np.array([0.03109772, 0.05781324, 0.13319437]),
            np.array([0.08997778, 0.08188593, 0.07961698]),
            np.array([0.17887873, 0.21295485, 0.04139516]),
            np.array([0.01614252, 0.22145846, 0.17920186]),
            np.array([0.2383463 , 0.0748208 , 0.08785658]),
            np.array([0.15383377, 0.14244447, 0.10746095]),
            np.array([0.04010639, 0.18103592, 0.0130486 ]),
            np.array([0.06257228, 0.29220111, 0.00125325]),
            np.array([0.06414304, 0.254131  , 0.09209347]),
            np.array([0.09284317, 0.08958574, 0.15799134]),
            np.array([0.12961795, 0.03054528, 0.07497151]),
            np.array([0.04067262, 0.15809277, 0.06113907]),
            np.array([0.04239182, 0.16211177, 0.14733439]),
            np.array([0.11380315, 0.04305786, 0.17071568]),
            np.array([0.06816976, 0.00179346, 0.04631972]),
            np.array([0.10802647, 0.02217225, 0.00599246]),
            np.array([0.00586853, 0.24533565, 0.16347356]),
            np.array([0.00123726, 0.23259682, 0.1058752 ]),
            np.array([0.27975545, 0.04108462, 0.02471266]),
            np.array([0.0998797 , 0.10741366, 0.25286662]),
            np.array([0.04842353, 0.16110137, 0.16233107]),
            np.array([0.0509332 , 0.10166057, 0.27372989]),
            np.array([0.19264889, 0.16616232, 0.06180992]),
            np.array([0.19847065, 0.14583715, 0.13275077]),
            np.array([0.22597414, 0.17910547, 0.05840158]),
            np.array([0.2120834 , 0.16434841, 0.02007916]),
            np.array([0.04329565, 0.2809441 , 0.0791985 ]),
            np.array([0.09892367, 0.13347568, 0.23411521]),
            np.array([0.18921646, 0.0254934 , 0.22418247]),
            np.array([0.10654903, 0.02513713, 0.21391664]),
            np.array([0.11384655, 0.19330981, 0.05382412]),
            np.array([0.25966741, 0.00231558, 0.10821897]),
            np.array([0.08849618, 0.10273877, 0.01463384]),
            np.array([0.13255496, 0.20737058, 0.02792361]),
            np.array([0.14157651, 0.18739985, 0.13740436]),
            np.array([0.03050341, 0.15691038, 0.19564674]),
            np.array([0.26002477, 0.00841683, 0.13617243]),
            np.array([0.22238969, 0.18576985, 0.00349597]),
            np.array([0.20008272, 0.21253078, 0.00570972]),
            np.array([0.17380425, 0.06472133, 0.11826108]),
            np.array([0.03873955, 0.19725418, 0.04720055]),
            np.array([0.05586554, 0.20814951, 0.13697571]),
            np.array([0.04565449, 0.01472906, 0.0852556 ]),
            np.array([0.04293809, 0.29136752, 0.00135179]),
            np.array([0.03821408, 0.06936401, 0.02595715]),
            np.array([0.00123967, 0.23923315, 0.11170531]),
            np.array([0.01950993, 0.00255121, 0.13999153]),
            np.array([0.2751632 , 0.07556494, 0.06250738]),
            np.array([0.20637726, 0.0648869 , 0.13379492]),
            np.array([0.17914648, 0.04802295, 0.16063325]),
            np.array([0.11297754, 0.11670623, 0.10206259]),
            np.array([0.06619797, 0.20700306, 0.01395635]),
            np.array([0.13834996, 0.14780951, 0.16336846]),
            np.array([0.18523555, 0.23541688, 0.00952733]),
            np.array([0.08522869, 0.09505661, 0.06516662]),
            np.array([0.23612589, 0.14303088, 0.01600968]),
            np.array([0.06824194, 0.20458077, 0.0379285 ]),
            np.array([0.12821887, 0.03520333, 0.0048195 ]),
            np.array([0.03317   , 0.05212797, 0.05883483]),
            np.array([0.06194256, 0.25043402, 0.12733343]),
            np.array([0.23800564, 0.13477116, 0.07588774]),
            np.array([0.09093939, 0.27187176, 0.06255886]),
            np.array([0.08641943, 0.11744407, 0.16648038]),
            np.array([0.26746928, 0.08608354, 0.04808151]),
            np.array([0.20087507, 0.08975431, 0.0919082 ]),
            np.array([0.1715015 , 0.16669419, 0.10888851]),
            np.array([0.05985321, 0.20303498, 0.16396186]),
            np.array([0.19127081, 0.21700355, 0.03552037]),
            np.array([0.14328193, 0.09473562, 0.12746634]),
            np.array([0.06652446, 0.09530574, 0.20289727]),
            np.array([0.00212435, 0.27870466, 0.09625596]),
            np.array([0.00133912, 0.21233167, 0.14873419]),
            np.array([0.17005066, 0.13807191, 0.00483463]),
            np.array([0.1234432 , 0.12187643, 0.18956935]),
            np.array([0.0924941 , 0.26346268, 0.05836817]),
            np.array([0.16742412, 0.11465058, 0.04540342]),
            np.array([0.23026988, 0.11315321, 0.03623322]),
            np.array([0.19512978, 0.07946028, 0.14053002]),
            np.array([0.13386035, 0.04788852, 0.20586109]),
            np.array([0.13138548, 0.03410095, 0.17721465]),
            np.array([0.10302931, 0.1454456 , 0.1888906 ]),
            np.array([0.18463277, 0.23561722, 0.0143786 ]),
            np.array([0.17217613, 0.23355376, 0.07607669]),
            np.array([0.28725304, 0.04629072, 0.01303354]),
            np.array([0.14858921, 0.18659913, 0.12354305]),
            np.array([0.09153606, 0.01814574, 0.00409722]),
            np.array([0.28086746, 0.0948185 , 0.00180343]),
            np.array([0.0677463 , 0.23210142, 0.01130163]),
            np.array([0.05593071, 0.10867454, 0.07258079]),
            np.array([0.13415668, 0.20083854, 0.06185348]),
            np.array([0.20395251, 0.17296762, 0.0223744 ]),
            np.array([0.03322968, 0.10743056, 0.00058808]),
            np.array([0.1595255 , 0.06357125, 0.05098563]),
            np.array([0.16441605, 0.10435734, 0.17472137]),
            np.array([0.06720247, 0.03772779, 0.20233528]),
            np.array([0.12498108, 0.12780832, 0.00648564]),
            np.array([0.07683371, 0.26811166, 0.07794433]),
            np.array([0.09201309, 0.24297988, 0.09301611]),
            np.array([0.2218774 , 0.04549159, 0.06453003]),
            np.array([0.02568134, 0.16337871, 0.23898173]),
            np.array([0.0452318 , 0.23499234, 0.11886153]),
            np.array([0.04722691, 0.09307442, 0.12942773]),
            np.array([0.14603967, 0.10650362, 0.18066945]),
            np.array([0.24876895, 0.14381045, 0.04887364]),
            np.array([0.19449685, 0.07176904, 0.13295132]),
            np.array([0.12408233, 0.11348128, 0.01442846]),
            np.array([0.00437644, 0.12223801, 0.18381361]),
            np.array([0.12963344, 0.07217126, 0.23501474]),
            np.array([0.19668233, 0.09122984, 0.10652394]),
            np.array([0.0433664 , 0.1419562 , 0.25177607]),
            np.array([0.27352068, 0.08111089, 0.02902535]),
            np.array([0.15750757, 0.00659976, 0.12876866]),
            np.array([0.04176833, 0.24964858, 0.04268907]),
            np.array([0.22870738, 0.08550192, 0.06464655]),
            np.array([0.03385241, 0.25092405, 0.1254248 ]),
            np.array([0.1028429 , 0.0663055 , 0.15456477]),
            np.array([0.09165711, 0.04972029, 0.17863305]),
            np.array([0.16914452, 0.06846731, 0.17883501]),
            np.array([0.21382006, 0.17122172, 0.11393659]),
            np.array([0.14275804, 0.07466466, 0.00939601]),
            np.array([0.29157373, 0.02562523, 0.04132319]),
            np.array([0.20042751, 0.10542359, 0.04852195]),
            np.array([0.04791158, 0.07778994, 0.06039454])
        ])
        self.point_collection["modello_24.urdf"] = pd.DataFrame([
            np.array([0.31861543, 0.15816079, 0.28496201]),
            np.array([0.49275099, 0.22084054, 0.31807181]),
            np.array([0.2348043 , 0.10613487, 0.32250541]),
            np.array([0.17775675, 0.519426  , 0.10617951]),
            np.array([0.33117084, 0.2980355 , 0.19009839]),
            np.array([0.10546895, 0.33454682, 0.34755569]),
            np.array([0.39282142, 0.40390866, 0.22823837]),
            np.array([0.03370044, 0.55310725, 0.12576648]),
            np.array([0.04454427, 0.20087572, 0.57452023]),
            np.array([0.18059566, 0.50192333, 0.35866297]),
            np.array([0.1831605 , 0.41343392, 0.05766783]),
            np.array([0.02145817, 0.61416589, 0.12013379]),
            np.array([0.23722927, 0.4460672 , 0.37387453]),
            np.array([0.35095151, 0.03852729, 0.45769473]),
            np.array([0.16395647, 0.11836437, 0.5891874 ]),
            np.array([0.25182589, 0.17208007, 0.3296363 ]),
            np.array([0.44717712, 0.15171154, 0.31519082]),
            np.array([0.1839623 , 0.13288924, 0.4596748 ]),
            np.array([0.51879246, 0.21294621, 0.20213963]),
            np.array([0.66131031, 0.16032578, 0.09122353]),
            np.array([0.37974778, 0.13680757, 0.34424527]),
            np.array([0.12497597, 0.17792766, 0.03604084]),
            np.array([0.04039343, 0.05512149, 0.60495413]),
            np.array([0.07731969, 0.0311888 , 0.22036119]),
            np.array([0.10393383, 0.42649017, 0.41414045]),
            np.array([0.07319089, 0.10338514, 0.36862522]),
            np.array([0.55345303, 0.02116609, 0.12662651]),
            np.array([0.56208481, 0.31421995, 0.25662864]),
            np.array([0.0538454 , 0.67775318, 0.16383383]),
            np.array([0.619888  , 0.24460697, 0.03290336]),
            np.array([0.13653163, 0.20123045, 0.50591951]),
            np.array([0.15321193, 0.1047938 , 0.64193581]),
            np.array([0.30316129, 0.02504209, 0.20728174]),
            np.array([0.1628979 , 0.52743082, 0.16200452]),
            np.array([0.12553607, 0.36039669, 0.39373911]),
            np.array([0.59658697, 0.0876787 , 0.04451204]),
            np.array([0.09382921, 0.17033021, 0.13077394]),
            np.array([0.41156915, 0.01644389, 0.31593076]),
            np.array([0.39690411, 0.08239122, 0.11370194]),
            np.array([0.03769767, 0.69783332, 0.03109261]),
            np.array([0.30182545, 0.17004636, 0.11716442]),
            np.array([0.03286018, 0.36396415, 0.17768196]),
            np.array([0.08363827, 0.27874645, 0.17900941]),
            np.array([0.13268762, 0.49108776, 0.25538796]),
            np.array([0.3336036 , 0.07387333, 0.22060152]),
            np.array([0.66934834, 0.01832704, 0.15598869]),
            np.array([0.16061349, 0.2576372 , 0.1956203 ]),
            np.array([0.60208119, 0.05775833, 0.02142658]),
            np.array([0.28977465, 0.12207835, 0.16681674]),
            np.array([0.56580111, 0.22192581, 0.13485227]),
            np.array([0.55980365, 0.11126028, 0.27857661]),
            np.array([0.4770624 , 0.1486219 , 0.08119328]),
            np.array([0.58795192, 0.37527234, 0.0301271 ]),
            np.array([0.40196026, 0.04753173, 0.11199934]),
            np.array([0.10825501, 0.68326185, 0.02224859]),
            np.array([0.37562525, 0.23271618, 0.33433831]),
            np.array([0.42500925, 0.29045773, 0.21260551]),
            np.array([0.45121221, 0.17761514, 0.36772449]),
            np.array([0.57503419, 0.07469905, 0.13912527]),
            np.array([0.64731365, 0.2258552 , 0.04552015]),
            np.array([0.06458713, 0.4064581 , 0.31653279]),
            np.array([0.31981388, 0.47929999, 0.02582022]),
            np.array([0.24016471, 0.11704934, 0.17460284]),
            np.array([0.24053909, 0.47119427, 0.09129969]),
            np.array([0.09413238, 0.47424004, 0.32042263]),
            np.array([0.30571014, 0.02104333, 0.44642481]),
            np.array([0.59158608, 0.12048078, 0.07819736]),
            np.array([0.17772331, 0.08122913, 0.06846227]),
            np.array([0.06919122, 0.59292784, 0.01876035]),
            np.array([0.41332784, 0.27747701, 0.47556442]),
            np.array([0.11093377, 0.32992528, 0.54751534]),
            np.array([0.02652946, 0.26704467, 0.0140826 ]),
            np.array([0.36355739, 0.12245052, 0.51859777]),
            np.array([0.29035254, 0.27042125, 0.52793838]),
            np.array([0.04085351, 0.58660254, 0.27869192]),
            np.array([0.65860721, 0.00284292, 0.06024385]),
            np.array([0.67559651, 0.16266142, 0.0752175 ]),
            np.array([0.02029084, 0.47848638, 0.13355189]),
            np.array([0.41407597, 0.3246866 , 0.38530592]),
            np.array([0.43156963, 0.21794888, 0.09040929]),
            np.array([0.2623553 , 0.28883422, 0.02613188]),
            np.array([0.26117517, 0.08213295, 0.33794916]),
            np.array([0.10919267, 0.09603656, 0.12451957]),
            np.array([0.47798535, 0.34212237, 0.32250713]),
            np.array([0.46974542, 0.07389435, 0.42349849]),
            np.array([0.21698321, 0.54718321, 0.24910545]),
            np.array([0.52889855, 0.00145958, 0.34792041]),
            np.array([0.43317635, 0.25497527, 0.02868597]),
            np.array([0.66507453, 0.10781504, 0.02842696]),
            np.array([0.30758916, 0.31776092, 0.31848493]),
            np.array([0.33221268, 0.00662443, 0.34272415]),
            np.array([0.50892195, 0.10747634, 0.40144246]),
            np.array([0.0911104 , 0.36520887, 0.13797816]),
            np.array([0.26749178, 0.0463433 , 0.15250121]),
            np.array([0.40748713, 0.48101929, 0.171621  ]),
            np.array([0.1250867 , 0.61678772, 0.26808054]),
            np.array([0.45638284, 0.22887794, 0.38160669]),
            np.array([0.08115568, 0.59098112, 0.24501687]),
            np.array([0.09307974, 0.09273916, 0.45318131]),
            np.array([0.22028795, 0.0853637 , 0.01888352]),
            np.array([0.56625359, 0.26066791, 0.24315221]),
            np.array([0.1367573 , 0.01921222, 0.02319986]),
            np.array([0.05350221, 0.20991577, 0.08382473]),
            np.array([0.68762419, 0.01862905, 0.06873924]),
            np.array([0.09368114, 0.05919474, 0.49763803]),
            np.array([0.39879298, 0.07885163, 0.37332005]),
            np.array([0.3386906 , 0.25935214, 0.01854973]),
            np.array([0.10891635, 0.51317578, 0.29435902]),
            np.array([0.04691714, 0.08114907, 0.55569341]),
            np.array([0.43979744, 0.40719387, 0.1993094 ]),
            np.array([0.57098677, 0.40239838, 0.04107148]),
            np.array([0.40541982, 0.2840461 , 0.02144944]),
            np.array([0.05215825, 0.54776743, 0.2828247 ]),
            np.array([0.48551256, 0.04647256, 0.30570534]),
            np.array([0.00450678, 0.5609043 , 0.40861912]),
            np.array([0.01896098, 0.32619476, 0.44215076]),
            np.array([0.26366382, 0.60696666, 0.03009697]),
            np.array([0.24767635, 0.38701268, 0.50348025]),
            np.array([0.54141079, 0.21600764, 0.15932517]),
            np.array([0.12140857, 0.41008628, 0.45405674]),
            np.array([0.11401138, 0.61286705, 0.14297482]),
            np.array([0.01917559, 0.14083346, 0.3700346 ]),
            np.array([0.02018302, 0.50163137, 0.10107573]),
            np.array([0.3464997 , 0.2772817 , 0.00902407]),
            np.array([0.14822526, 0.47825877, 0.12107359]),
            np.array([0.06615439, 0.36325256, 0.30446505]),
            np.array([0.13990066, 0.25458034, 0.27647508]),
            np.array([0.28705272, 0.60492659, 0.17821992]),
            np.array([0.16877636, 0.39414921, 0.47231562]),
            np.array([0.25668914, 0.39955211, 0.19822389]),
            np.array([0.10207181, 0.21985087, 0.31279066]),
            np.array([0.16809655, 0.10814429, 0.11366361]),
            np.array([0.43062643, 0.32617318, 0.4362496 ]),
            np.array([0.45419055, 0.38348103, 0.17611171]),
            np.array([0.66847608, 0.18512988, 0.01877706]),
            np.array([0.1673213 , 0.07291284, 0.38641986]),
            np.array([0.32112417, 0.08444267, 0.34585332]),
            np.array([0.02160846, 0.25248222, 0.13171414]),
            np.array([0.4734025 , 0.40628539, 0.0941384 ]),
            np.array([0.22111933, 0.24254363, 0.16617823]),
            np.array([0.250631  , 0.503687  , 0.28247354]),
            np.array([0.63632988, 0.19027693, 0.18086252]),
            np.array([0.26951037, 0.39802263, 0.18101542]),
            np.array([0.21250996, 0.16609483, 0.64289232]),
            np.array([0.32269293, 0.28432652, 0.23722637]),
            np.array([0.28415587, 0.05978163, 0.61695693]),
            np.array([0.11643074, 0.1899263 , 0.0015729 ]),
            np.array([0.69212069, 0.00323525, 0.07279731]),
            np.array([0.63892438, 0.07846603, 0.0735813 ]),
            np.array([0.01763665, 0.11333499, 0.25454906]),
            np.array([0.53039417, 0.30614178, 0.28933933]),
            np.array([0.28248212, 0.58318843, 0.05832197]),
            np.array([0.58205358, 0.33731952, 0.11696176]),
            np.array([0.40388967, 0.42643951, 0.02627208]),
            np.array([0.65058889, 0.06967963, 0.13836739]),
            np.array([0.35047627, 0.14246604, 0.57909104]),
            np.array([0.0125447 , 0.56935374, 0.29539569]),
            np.array([0.39156111, 0.19041585, 0.16673343]),
            np.array([0.06273296, 0.1262389 , 0.01702262]),
            np.array([0.21006773, 0.23463913, 0.33015692]),
            np.array([0.10130309, 0.23194838, 0.47396884]),
            np.array([0.33625384, 0.25848614, 0.53269128]),
            np.array([0.00139221, 0.30388684, 0.16081776]),
            np.array([0.44459155, 0.42370495, 0.11989082]),
            np.array([0.03272489, 0.4164062 , 0.4694174 ]),
            np.array([0.03735541, 0.6494154 , 0.22892331]),
            np.array([0.31324806, 0.47467832, 0.40054913]),
            np.array([0.60967089, 0.15927834, 0.21042373]),
            np.array([0.27184377, 0.28866861, 0.14547966]),
            np.array([0.69115592, 0.02471727, 0.04470759]),
            np.array([0.24348544, 0.65387756, 0.02670585]),
            np.array([0.35100962, 0.43274664, 0.39807407]),
            np.array([0.28942622, 0.03875707, 0.41753058]),
            np.array([0.21599703, 0.05411007, 0.59574103]),
            np.array([0.02065259, 0.36660352, 0.07295585]),
            np.array([0.57684151, 0.32873516, 0.00780907]),
            np.array([0.12303361, 0.1790383 , 0.45230492]),
            np.array([0.25822613, 0.59647965, 0.23963143]),
            np.array([0.06265765, 0.29509764, 0.27338655]),
            np.array([0.29674988, 0.59521359, 0.1761172 ]),
            np.array([0.30785482, 0.41144276, 0.35991208]),
            np.array([0.01482595, 0.09188458, 0.37557381]),
            np.array([0.29715467, 0.55143195, 0.02971902]),
            np.array([0.25942952, 0.24127476, 0.53067409]),
            np.array([0.00495868, 0.17608109, 0.03823329]),
            np.array([0.07763638, 0.05764922, 0.56900941]),
            np.array([0.29913136, 0.53874754, 0.30759003]),
            np.array([0.11565866, 0.28572149, 0.2337721 ]),
            np.array([0.02068489, 0.53705265, 0.1952476 ]),
            np.array([0.42568398, 0.314458  , 0.02080007]),
            np.array([0.20271541, 0.17695352, 0.1586712 ]),
            np.array([0.21690305, 0.25364403, 0.54901507]),
            np.array([0.2165772 , 0.19372318, 0.14131203]),
            np.array([0.13663015, 0.11789571, 0.61314577]),
            np.array([0.40655058, 0.4779077 , 0.05174   ]),
            np.array([0.16478168, 0.07583114, 0.58814423]),
            np.array([0.41262568, 0.44400091, 0.03021207]),
            np.array([0.00051468, 0.32959858, 0.0259874 ]),
            np.array([0.13808136, 0.53317534, 0.01516865]),
            np.array([0.34206708, 0.2332736 , 0.21735025])
        ])
        self.point_collection["modello_32.urdf"] = pd.DataFrame([
            np.array([0.31861543, 0.15816079, 0.28496201]),
            np.array([0.49275099, 0.22084054, 0.31807181]),
            np.array([0.2348043 , 0.10613487, 0.32250541]),
            np.array([0.17775675, 0.519426  , 0.10617951]),
            np.array([0.33117084, 0.2980355 , 0.19009839]),
            np.array([0.10546895, 0.33454682, 0.34755569]),
            np.array([0.39282142, 0.40390866, 0.22823837]),
            np.array([0.03370044, 0.55310725, 0.12576648]),
            np.array([0.04454427, 0.20087572, 0.57452023]),
            np.array([0.18059566, 0.50192333, 0.35866297]),
            np.array([0.1831605 , 0.41343392, 0.05766783]),
            np.array([0.02145817, 0.61416589, 0.12013379]),
            np.array([0.23722927, 0.4460672 , 0.37387453]),
            np.array([0.35095151, 0.03852729, 0.45769473]),
            np.array([0.16395647, 0.11836437, 0.5891874 ]),
            np.array([0.25182589, 0.17208007, 0.3296363 ]),
            np.array([0.44717712, 0.15171154, 0.31519082]),
            np.array([0.1839623 , 0.13288924, 0.4596748 ]),
            np.array([0.51879246, 0.21294621, 0.20213963]),
            np.array([0.66131031, 0.16032578, 0.09122353]),
            np.array([0.37974778, 0.13680757, 0.34424527]),
            np.array([0.12497597, 0.17792766, 0.03604084]),
            np.array([0.04039343, 0.05512149, 0.60495413]),
            np.array([0.07731969, 0.0311888 , 0.22036119]),
            np.array([0.10393383, 0.42649017, 0.41414045]),
            np.array([0.07319089, 0.10338514, 0.36862522]),
            np.array([0.55345303, 0.02116609, 0.12662651]),
            np.array([0.56208481, 0.31421995, 0.25662864]),
            np.array([0.0538454 , 0.67775318, 0.16383383]),
            np.array([0.619888  , 0.24460697, 0.03290336]),
            np.array([0.13653163, 0.20123045, 0.50591951]),
            np.array([0.15321193, 0.1047938 , 0.64193581]),
            np.array([0.30316129, 0.02504209, 0.20728174]),
            np.array([0.1628979 , 0.52743082, 0.16200452]),
            np.array([0.12553607, 0.36039669, 0.39373911]),
            np.array([0.59658697, 0.0876787 , 0.04451204]),
            np.array([0.09382921, 0.17033021, 0.13077394]),
            np.array([0.41156915, 0.01644389, 0.31593076]),
            np.array([0.39690411, 0.08239122, 0.11370194]),
            np.array([0.03769767, 0.69783332, 0.03109261]),
            np.array([0.30182545, 0.17004636, 0.11716442]),
            np.array([0.03286018, 0.36396415, 0.17768196]),
            np.array([0.08363827, 0.27874645, 0.17900941]),
            np.array([0.13268762, 0.49108776, 0.25538796]),
            np.array([0.3336036 , 0.07387333, 0.22060152]),
            np.array([0.66934834, 0.01832704, 0.15598869]),
            np.array([0.16061349, 0.2576372 , 0.1956203 ]),
            np.array([0.60208119, 0.05775833, 0.02142658]),
            np.array([0.28977465, 0.12207835, 0.16681674]),
            np.array([0.56580111, 0.22192581, 0.13485227]),
            np.array([0.55980365, 0.11126028, 0.27857661]),
            np.array([0.4770624 , 0.1486219 , 0.08119328]),
            np.array([0.58795192, 0.37527234, 0.0301271 ]),
            np.array([0.40196026, 0.04753173, 0.11199934]),
            np.array([0.10825501, 0.68326185, 0.02224859]),
            np.array([0.37562525, 0.23271618, 0.33433831]),
            np.array([0.42500925, 0.29045773, 0.21260551]),
            np.array([0.45121221, 0.17761514, 0.36772449]),
            np.array([0.57503419, 0.07469905, 0.13912527]),
            np.array([0.64731365, 0.2258552 , 0.04552015]),
            np.array([0.06458713, 0.4064581 , 0.31653279]),
            np.array([0.31981388, 0.47929999, 0.02582022]),
            np.array([0.24016471, 0.11704934, 0.17460284]),
            np.array([0.24053909, 0.47119427, 0.09129969]),
            np.array([0.09413238, 0.47424004, 0.32042263]),
            np.array([0.30571014, 0.02104333, 0.44642481]),
            np.array([0.59158608, 0.12048078, 0.07819736]),
            np.array([0.17772331, 0.08122913, 0.06846227]),
            np.array([0.06919122, 0.59292784, 0.01876035]),
            np.array([0.41332784, 0.27747701, 0.47556442]),
            np.array([0.11093377, 0.32992528, 0.54751534]),
            np.array([0.02652946, 0.26704467, 0.0140826 ]),
            np.array([0.36355739, 0.12245052, 0.51859777]),
            np.array([0.29035254, 0.27042125, 0.52793838]),
            np.array([0.04085351, 0.58660254, 0.27869192]),
            np.array([0.65860721, 0.00284292, 0.06024385]),
            np.array([0.67559651, 0.16266142, 0.0752175 ]),
            np.array([0.02029084, 0.47848638, 0.13355189]),
            np.array([0.41407597, 0.3246866 , 0.38530592]),
            np.array([0.43156963, 0.21794888, 0.09040929]),
            np.array([0.2623553 , 0.28883422, 0.02613188]),
            np.array([0.26117517, 0.08213295, 0.33794916]),
            np.array([0.10919267, 0.09603656, 0.12451957]),
            np.array([0.47798535, 0.34212237, 0.32250713]),
            np.array([0.46974542, 0.07389435, 0.42349849]),
            np.array([0.21698321, 0.54718321, 0.24910545]),
            np.array([0.52889855, 0.00145958, 0.34792041]),
            np.array([0.43317635, 0.25497527, 0.02868597]),
            np.array([0.66507453, 0.10781504, 0.02842696]),
            np.array([0.30758916, 0.31776092, 0.31848493]),
            np.array([0.33221268, 0.00662443, 0.34272415]),
            np.array([0.50892195, 0.10747634, 0.40144246]),
            np.array([0.0911104 , 0.36520887, 0.13797816]),
            np.array([0.26749178, 0.0463433 , 0.15250121]),
            np.array([0.40748713, 0.48101929, 0.171621  ]),
            np.array([0.1250867 , 0.61678772, 0.26808054]),
            np.array([0.45638284, 0.22887794, 0.38160669]),
            np.array([0.08115568, 0.59098112, 0.24501687]),
            np.array([0.09307974, 0.09273916, 0.45318131]),
            np.array([0.22028795, 0.0853637 , 0.01888352]),
            np.array([0.56625359, 0.26066791, 0.24315221]),
            np.array([0.1367573 , 0.01921222, 0.02319986]),
            np.array([0.05350221, 0.20991577, 0.08382473]),
            np.array([0.68762419, 0.01862905, 0.06873924]),
            np.array([0.09368114, 0.05919474, 0.49763803]),
            np.array([0.39879298, 0.07885163, 0.37332005]),
            np.array([0.3386906 , 0.25935214, 0.01854973]),
            np.array([0.10891635, 0.51317578, 0.29435902]),
            np.array([0.04691714, 0.08114907, 0.55569341]),
            np.array([0.43979744, 0.40719387, 0.1993094 ]),
            np.array([0.57098677, 0.40239838, 0.04107148]),
            np.array([0.40541982, 0.2840461 , 0.02144944]),
            np.array([0.05215825, 0.54776743, 0.2828247 ]),
            np.array([0.48551256, 0.04647256, 0.30570534]),
            np.array([0.00450678, 0.5609043 , 0.40861912]),
            np.array([0.01896098, 0.32619476, 0.44215076]),
            np.array([0.26366382, 0.60696666, 0.03009697]),
            np.array([0.24767635, 0.38701268, 0.50348025]),
            np.array([0.54141079, 0.21600764, 0.15932517]),
            np.array([0.12140857, 0.41008628, 0.45405674]),
            np.array([0.11401138, 0.61286705, 0.14297482]),
            np.array([0.01917559, 0.14083346, 0.3700346 ]),
            np.array([0.02018302, 0.50163137, 0.10107573]),
            np.array([0.3464997 , 0.2772817 , 0.00902407]),
            np.array([0.14822526, 0.47825877, 0.12107359]),
            np.array([0.06615439, 0.36325256, 0.30446505]),
            np.array([0.13990066, 0.25458034, 0.27647508]),
            np.array([0.28705272, 0.60492659, 0.17821992]),
            np.array([0.16877636, 0.39414921, 0.47231562]),
            np.array([0.25668914, 0.39955211, 0.19822389]),
            np.array([0.10207181, 0.21985087, 0.31279066]),
            np.array([0.16809655, 0.10814429, 0.11366361]),
            np.array([0.43062643, 0.32617318, 0.4362496 ]),
            np.array([0.45419055, 0.38348103, 0.17611171]),
            np.array([0.66847608, 0.18512988, 0.01877706]),
            np.array([0.1673213 , 0.07291284, 0.38641986]),
            np.array([0.32112417, 0.08444267, 0.34585332]),
            np.array([0.02160846, 0.25248222, 0.13171414]),
            np.array([0.4734025 , 0.40628539, 0.0941384 ]),
            np.array([0.22111933, 0.24254363, 0.16617823]),
            np.array([0.250631  , 0.503687  , 0.28247354]),
            np.array([0.63632988, 0.19027693, 0.18086252]),
            np.array([0.26951037, 0.39802263, 0.18101542]),
            np.array([0.21250996, 0.16609483, 0.64289232]),
            np.array([0.32269293, 0.28432652, 0.23722637]),
            np.array([0.28415587, 0.05978163, 0.61695693]),
            np.array([0.11643074, 0.1899263 , 0.0015729 ]),
            np.array([0.69212069, 0.00323525, 0.07279731]),
            np.array([0.63892438, 0.07846603, 0.0735813 ]),
            np.array([0.01763665, 0.11333499, 0.25454906]),
            np.array([0.53039417, 0.30614178, 0.28933933]),
            np.array([0.28248212, 0.58318843, 0.05832197]),
            np.array([0.58205358, 0.33731952, 0.11696176]),
            np.array([0.40388967, 0.42643951, 0.02627208]),
            np.array([0.65058889, 0.06967963, 0.13836739]),
            np.array([0.35047627, 0.14246604, 0.57909104]),
            np.array([0.0125447 , 0.56935374, 0.29539569]),
            np.array([0.39156111, 0.19041585, 0.16673343]),
            np.array([0.06273296, 0.1262389 , 0.01702262]),
            np.array([0.21006773, 0.23463913, 0.33015692]),
            np.array([0.10130309, 0.23194838, 0.47396884]),
            np.array([0.33625384, 0.25848614, 0.53269128]),
            np.array([0.00139221, 0.30388684, 0.16081776]),
            np.array([0.44459155, 0.42370495, 0.11989082]),
            np.array([0.03272489, 0.4164062 , 0.4694174 ]),
            np.array([0.03735541, 0.6494154 , 0.22892331]),
            np.array([0.31324806, 0.47467832, 0.40054913]),
            np.array([0.60967089, 0.15927834, 0.21042373]),
            np.array([0.27184377, 0.28866861, 0.14547966]),
            np.array([0.69115592, 0.02471727, 0.04470759]),
            np.array([0.24348544, 0.65387756, 0.02670585]),
            np.array([0.35100962, 0.43274664, 0.39807407]),
            np.array([0.28942622, 0.03875707, 0.41753058]),
            np.array([0.21599703, 0.05411007, 0.59574103]),
            np.array([0.02065259, 0.36660352, 0.07295585]),
            np.array([0.57684151, 0.32873516, 0.00780907]),
            np.array([0.12303361, 0.1790383 , 0.45230492]),
            np.array([0.25822613, 0.59647965, 0.23963143]),
            np.array([0.06265765, 0.29509764, 0.27338655]),
            np.array([0.29674988, 0.59521359, 0.1761172 ]),
            np.array([0.30785482, 0.41144276, 0.35991208]),
            np.array([0.01482595, 0.09188458, 0.37557381]),
            np.array([0.29715467, 0.55143195, 0.02971902]),
            np.array([0.25942952, 0.24127476, 0.53067409]),
            np.array([0.00495868, 0.17608109, 0.03823329]),
            np.array([0.07763638, 0.05764922, 0.56900941]),
            np.array([0.29913136, 0.53874754, 0.30759003]),
            np.array([0.11565866, 0.28572149, 0.2337721 ]),
            np.array([0.02068489, 0.53705265, 0.1952476 ]),
            np.array([0.42568398, 0.314458  , 0.02080007]),
            np.array([0.20271541, 0.17695352, 0.1586712 ]),
            np.array([0.21690305, 0.25364403, 0.54901507]),
            np.array([0.2165772 , 0.19372318, 0.14131203]),
            np.array([0.13663015, 0.11789571, 0.61314577]),
            np.array([0.40655058, 0.4779077 , 0.05174   ]),
            np.array([0.16478168, 0.07583114, 0.58814423]),
            np.array([0.41262568, 0.44400091, 0.03021207]),
            np.array([0.00051468, 0.32959858, 0.0259874 ]),
            np.array([0.13808136, 0.53317534, 0.01516865]),
            np.array([0.34206708, 0.2332736 , 0.21735025])
        ])
        self.point_collection["modello_40.urdf"] = pd.DataFrame([
            np.array([0.73421065, 0.13606025, 0.52219124]),
            np.array([0.23593536, 0.53715591, 0.67264895]),
            np.array([0.09048561, 0.49366582, 0.37931701]),
            np.array([0.00130088, 0.02611725, 0.07473439]),
            np.array([0.57452646, 0.34690901, 0.56357599]),
            np.array([0.90302856, 0.12012988, 0.60399138]),
            np.array([0.69826369, 0.68616152, 0.34833444]),
            np.array([0.61579069, 0.76809797, 0.31370605]),
            np.array([0.14622522, 0.25109339, 0.39465539]),
            np.array([0.07323638, 0.14552098, 0.87847462]),
            np.array([0.32355608, 0.95608357, 0.01049507]),
            np.array([0.58347673, 0.28076813, 0.61066997]),
            np.array([0.73740318, 0.21005519, 0.02243143]),
            np.array([0.22331177, 0.365119  , 0.32290528]),
            np.array([0.55533854, 0.0479192 , 0.60947386]),
            np.array([0.28913192, 0.65855661, 0.48910848]),
            np.array([0.09682287, 1.0035243 , 0.22438912]),
            np.array([1.04607371, 0.0865429 , 0.21772268]),
            np.array([0.11316818, 0.57369629, 0.54014292]),
            np.array([1.00147019, 0.20646536, 0.356057  ]),
            np.array([0.36783223, 0.96923386, 0.16632849]),
            np.array([0.47511991, 0.44079616, 0.11864317]),
            np.array([0.16956829, 0.25172152, 0.59283404]),
            np.array([0.03478504, 0.71854231, 0.55933828]),
            np.array([0.10807989, 0.16100155, 0.20179907]),
            np.array([0.36058217, 0.77184562, 0.136778  ]),
            np.array([0.32667228, 0.63981055, 0.17636166]),
            np.array([1.03753083, 0.1850639 , 0.0503246 ]),
            np.array([0.08269892, 0.91704985, 0.03810512]),
            np.array([0.38529182, 0.52190598, 0.08262369]),
            np.array([0.74384869, 0.2335659 , 0.22424238]),
            np.array([0.82622205, 0.08744907, 0.5206648 ]),
            np.array([0.65711096, 0.64819132, 0.40587606]),
            np.array([0.05308271, 0.75905384, 0.72392542]),
            np.array([0.67223589, 0.04495639, 0.18636631]),
            np.array([0.04995339, 0.76384612, 0.40656318]),
            np.array([0.21680602, 0.61689715, 0.49474152]),
            np.array([0.08263036, 0.12516176, 1.02186276]),
            np.array([1.03008966, 0.31715966, 0.02761002]),
            np.array([0.05687686, 0.55352716, 0.46788073]),
            np.array([0.09646838, 0.89580861, 0.58885053]),
            np.array([0.28703808, 0.89405333, 0.1647548 ]),
            np.array([0.41113568, 0.21218028, 0.35683929]),
            np.array([0.67160723, 0.82890061, 0.19980259]),
            np.array([0.0081106 , 0.91858786, 0.08625452]),
            np.array([0.88005533, 0.29671132, 0.22193907]),
            np.array([0.81336142, 0.42639463, 0.48724128]),
            np.array([0.6051434 , 0.00082947, 0.38634862]),
            np.array([0.22246158, 0.2176052 , 0.38498056]),
            np.array([0.31304055, 0.62278564, 0.72940347]),
            np.array([0.03147347, 0.57795833, 0.35866292]),
            np.array([0.26762309, 0.29289352, 0.76859843]),
            np.array([0.37900288, 0.69606163, 0.34308584]),
            np.array([0.66049336, 0.25042713, 0.42393691]),
            np.array([0.75185864, 0.12980882, 0.25731232]),
            np.array([0.32423859, 0.13231009, 0.66529625]),
            np.array([0.18387872, 0.92621128, 0.41558175]),
            np.array([0.46965533, 0.05944903, 0.71811268]),
            np.array([0.50657673, 0.32827107, 0.77367329]),
            np.array([0.67794851, 0.0425902 , 0.79765397]),
            np.array([0.48502686, 0.57445648, 0.55215782]),
            np.array([0.4133027 , 0.68599076, 0.15554545]),
            np.array([0.64042845, 0.11637967, 0.46756321]),
            np.array([0.62490741, 0.07816275, 0.05361911]),
            np.array([0.69472941, 0.57802039, 0.33139409]),
            np.array([1.05635777, 0.2709248 , 0.03026843]),
            np.array([0.32230252, 0.03066249, 0.05329539]),
            np.array([0.75058153, 0.34064238, 0.48429545]),
            np.array([0.33889835, 0.15477747, 0.6950908 ]),
            np.array([0.87437107, 0.50971661, 0.24941165]),
            np.array([0.21939221, 1.0279108 , 0.08287706]),
            np.array([0.31570711, 0.06286902, 0.71206733]),
            np.array([0.45979423, 0.59539669, 0.6801963 ]),
            np.array([0.65418758, 0.73071749, 0.04796262]),
            np.array([0.65515363, 0.18722564, 0.6833174 ]),
            np.array([0.02864305, 0.30851838, 0.87364112]),
            np.array([0.58255828, 0.70288273, 0.03974124]),
            np.array([0.1535357 , 0.56233714, 0.91484405]),
            np.array([0.3137341 , 0.38677694, 0.20023799]),
            np.array([0.87173525, 0.37505845, 0.00764547]),
            np.array([0.56636345, 0.39505166, 0.50045829]),
            np.array([0.27970893, 1.01068246, 0.04950343]),
            np.array([0.87448259, 0.58970617, 0.04935179]),
            np.array([0.28402821, 0.40228578, 0.31806717]),
            np.array([0.27247315, 0.26977359, 0.12161675]),
            np.array([0.18385442, 0.57882869, 0.58113168]),
            np.array([0.61027091, 0.08581275, 0.83872018]),
            np.array([0.38982244, 0.63706978, 0.48723686]),
            np.array([0.43550758, 0.35681273, 0.61047623]),
            np.array([0.11868919, 0.38017402, 0.48030924]),
            np.array([0.17122824, 0.62079281, 0.81840896]),
            np.array([0.09335997, 0.48054792, 0.77523159]),
            np.array([0.75918624, 0.17978149, 0.00874249]),
            np.array([0.37810126, 0.75213724, 0.60044824]),
            np.array([0.70570748, 0.77168736, 0.27077333]),
            np.array([0.14443577, 0.88473475, 0.60187462]),
            np.array([0.81450688, 0.60581666, 0.15809067]),
            np.array([0.1479174 , 0.59236695, 0.454276  ]),
            np.array([0.86360807, 0.58125211, 0.19894549]),
            np.array([0.33712733, 0.2060519 , 0.63382552]),
            np.array([0.85479489, 0.47301101, 0.1794466 ]),
            np.array([0.06289833, 0.59065249, 0.00646191]),
            np.array([0.04769619, 0.26915204, 0.04594723]),
            np.array([0.76798227, 0.38105487, 0.52339437]),
            np.array([0.55240124, 0.91995874, 0.2170064 ]),
            np.array([0.36294857, 0.25920579, 0.80411569]),
            np.array([0.75005544, 0.3898593 , 0.50581892]),
            np.array([0.18582997, 0.13062453, 0.53882563]),
            np.array([0.8428691 , 0.6383752 , 0.23496268]),
            np.array([0.60327612, 0.26469889, 0.68782324]),
            np.array([0.74176617, 0.73927367, 0.28792778]),
            np.array([0.17546345, 0.20483974, 0.25456207]),
            np.array([0.66691185, 0.08658603, 0.39639171]),
            np.array([0.63815366, 0.69649931, 0.31503411]),
            np.array([0.28597246, 0.40753437, 0.79324874]),
            np.array([0.56284548, 0.66894059, 0.06161759]),
            np.array([0.41774815, 1.01130963, 0.03681965]),
            np.array([0.59944758, 0.16684703, 0.18351788]),
            np.array([0.50318229, 0.89301353, 0.0852893 ]),
            np.array([0.71855663, 0.0042067 , 0.48063133]),
            np.array([0.14651115, 0.26447009, 0.68554167]),
            np.array([0.1726972 , 0.88395738, 0.51149064]),
            np.array([0.41671532, 0.52921325, 0.02614592]),
            np.array([0.49879033, 0.43692417, 0.68462942]),
            np.array([0.26100647, 0.23871712, 0.87047299]),
            np.array([0.40780316, 0.85596182, 0.02898296]),
            np.array([0.22888002, 0.76484316, 0.31409819]),
            np.array([0.46392446, 0.96119123, 0.11385772]),
            np.array([0.91963433, 0.09911146, 0.4856595 ]),
            np.array([0.37048251, 0.11760599, 0.82466362]),
            np.array([0.32492622, 0.85240424, 0.19150415]),
            np.array([0.52489784, 0.60184005, 0.67842197]),
            np.array([0.2356886 , 0.65291186, 0.46115249]),
            np.array([0.46906933, 0.50443979, 0.36009005]),
            np.array([0.28214192, 0.22258837, 0.32775266]),
            np.array([0.25629504, 0.48597625, 0.3133556 ]),
            np.array([0.81442245, 0.0044474 , 0.304985  ]),
            np.array([0.82356354, 0.70609777, 0.16097634]),
            np.array([0.2312076 , 0.05104411, 0.20182606]),
            np.array([0.02455418, 0.33840867, 0.94929068]),
            np.array([0.6064126 , 0.51196768, 0.68774706]),
            np.array([0.37025694, 0.58460262, 0.79698042]),
            np.array([0.6630217 , 0.58271957, 0.09679542]),
            np.array([0.17498099, 0.19225113, 0.62008605]),
            np.array([0.53638526, 0.27324861, 0.37962415]),
            np.array([0.50579211, 0.07063959, 0.08103755]),
            np.array([0.33954587, 0.54123148, 0.84760221]),
            np.array([0.23143268, 0.73765752, 0.44732588]),
            np.array([0.70844638, 0.29248122, 0.20817968]),
            np.array([0.62544651, 0.56899907, 0.57602101]),
            np.array([0.96804217, 0.30647141, 0.31287735]),
            np.array([0.39778334, 0.48655861, 0.38714482]),
            np.array([0.16737659, 0.85109255, 0.03767355]),
            np.array([0.20825655, 0.54731413, 0.21908227]),
            np.array([1.04278838, 0.28165883, 0.04899547]),
            np.array([0.18934451, 0.42342707, 0.5534863 ]),
            np.array([0.76847053, 0.50893365, 0.24482788]),
            np.array([0.98780386, 0.20062533, 0.43498806]),
            np.array([0.98644813, 0.44002024, 0.18068546]),
            np.array([0.71310344, 0.28783569, 0.41860197]),
            np.array([0.1994464 , 1.01979639, 0.05776888]),
            np.array([0.26039073, 0.52178428, 0.46498496]),
            np.array([0.68825807, 0.64343035, 0.04222752]),
            np.array([0.57002564, 0.74124685, 0.12522906]),
            np.array([0.54625331, 0.23904283, 0.24453629]),
            np.array([0.19600689, 0.81163833, 0.66252707]),
            np.array([0.6237049 , 0.34329239, 0.21114596]),
            np.array([0.3400495 , 0.28954798, 0.52884357]),
            np.array([0.96367651, 0.4725961 , 0.23729786]),
            np.array([0.64790462, 0.38159002, 0.35065554]),
            np.array([0.72399658, 0.65282551, 0.47460005]),
            np.array([0.96500827, 0.28926472, 0.37386262]),
            np.array([0.30962839, 0.03293487, 0.46395507]),
            np.array([0.60488384, 0.23545868, 0.01315723]),
            np.array([0.00261337, 0.41513654, 0.84004601]),
            np.array([0.94259588, 0.52892945, 0.20211771]),
            np.array([0.31315602, 0.11493886, 0.44856067]),
            np.array([0.40310484, 0.386947  , 0.4124005 ]),
            np.array([0.61155506, 0.26066231, 0.32254078]),
            np.array([0.79386308, 0.55987354, 0.30372431]),
            np.array([0.42581701, 0.93143023, 0.32404426]),
            np.array([0.5354178 , 0.62303709, 0.58865099]),
            np.array([0.37327755, 0.74635528, 0.54024906]),
            np.array([0.42113101, 0.05068468, 0.08652672]),
            np.array([0.72905342, 0.67094494, 0.2485962 ]),
            np.array([0.81166114, 0.11519105, 0.51541104]),
            np.array([0.36695222, 0.50175474, 0.87875812]),
            np.array([0.99302158, 0.44794653, 0.15111727]),
            np.array([0.13122417, 0.05038683, 0.18875837]),
            np.array([0.16583975, 0.53951555, 0.46127601]),
            np.array([0.67076213, 0.59451269, 0.37878999]),
            np.array([0.54644717, 0.27616073, 0.88193512]),
            np.array([0.56272488, 0.4302011 , 0.20489658]),
            np.array([0.1747642 , 0.26807325, 0.10752018]),
            np.array([0.45319925, 0.8539065 , 0.34926719]),
            np.array([0.04955439, 0.61933384, 0.42248195]),
            np.array([0.15028697, 0.49653926, 0.19317881]),
            np.array([0.13497079, 0.27934641, 1.04542518]),
            np.array([0.16126977, 0.49071463, 0.57098942]),
            np.array([0.64918395, 0.67508168, 0.2059351 ])
        ])
        self.point_collection["modello_48.urdf"] = pd.DataFrame([
            np.array([0.73421065, 0.13606025, 0.52219124]),
            np.array([0.23593536, 0.53715591, 0.67264895]),
            np.array([0.09048561, 0.49366582, 0.37931701]),
            np.array([0.00130088, 0.02611725, 0.07473439]),
            np.array([0.57452646, 0.34690901, 0.56357599]),
            np.array([0.90302856, 0.12012988, 0.60399138]),
            np.array([0.69826369, 0.68616152, 0.34833444]),
            np.array([0.61579069, 0.76809797, 0.31370605]),
            np.array([0.14622522, 0.25109339, 0.39465539]),
            np.array([0.07323638, 0.14552098, 0.87847462]),
            np.array([0.32355608, 0.95608357, 0.01049507]),
            np.array([0.58347673, 0.28076813, 0.61066997]),
            np.array([0.73740318, 0.21005519, 0.02243143]),
            np.array([0.22331177, 0.365119  , 0.32290528]),
            np.array([0.55533854, 0.0479192 , 0.60947386]),
            np.array([0.28913192, 0.65855661, 0.48910848]),
            np.array([0.09682287, 1.0035243 , 0.22438912]),
            np.array([1.04607371, 0.0865429 , 0.21772268]),
            np.array([0.11316818, 0.57369629, 0.54014292]),
            np.array([1.00147019, 0.20646536, 0.356057  ]),
            np.array([0.36783223, 0.96923386, 0.16632849]),
            np.array([0.47511991, 0.44079616, 0.11864317]),
            np.array([0.16956829, 0.25172152, 0.59283404]),
            np.array([0.03478504, 0.71854231, 0.55933828]),
            np.array([0.10807989, 0.16100155, 0.20179907]),
            np.array([0.36058217, 0.77184562, 0.136778  ]),
            np.array([0.32667228, 0.63981055, 0.17636166]),
            np.array([1.03753083, 0.1850639 , 0.0503246 ]),
            np.array([0.08269892, 0.91704985, 0.03810512]),
            np.array([0.38529182, 0.52190598, 0.08262369]),
            np.array([0.74384869, 0.2335659 , 0.22424238]),
            np.array([0.82622205, 0.08744907, 0.5206648 ]),
            np.array([0.65711096, 0.64819132, 0.40587606]),
            np.array([0.05308271, 0.75905384, 0.72392542]),
            np.array([0.67223589, 0.04495639, 0.18636631]),
            np.array([0.04995339, 0.76384612, 0.40656318]),
            np.array([0.21680602, 0.61689715, 0.49474152]),
            np.array([0.08263036, 0.12516176, 1.02186276]),
            np.array([1.03008966, 0.31715966, 0.02761002]),
            np.array([0.05687686, 0.55352716, 0.46788073]),
            np.array([0.09646838, 0.89580861, 0.58885053]),
            np.array([0.28703808, 0.89405333, 0.1647548 ]),
            np.array([0.41113568, 0.21218028, 0.35683929]),
            np.array([0.67160723, 0.82890061, 0.19980259]),
            np.array([0.0081106 , 0.91858786, 0.08625452]),
            np.array([0.88005533, 0.29671132, 0.22193907]),
            np.array([0.81336142, 0.42639463, 0.48724128]),
            np.array([0.6051434 , 0.00082947, 0.38634862]),
            np.array([0.22246158, 0.2176052 , 0.38498056]),
            np.array([0.31304055, 0.62278564, 0.72940347]),
            np.array([0.03147347, 0.57795833, 0.35866292]),
            np.array([0.26762309, 0.29289352, 0.76859843]),
            np.array([0.37900288, 0.69606163, 0.34308584]),
            np.array([0.66049336, 0.25042713, 0.42393691]),
            np.array([0.75185864, 0.12980882, 0.25731232]),
            np.array([0.32423859, 0.13231009, 0.66529625]),
            np.array([0.18387872, 0.92621128, 0.41558175]),
            np.array([0.46965533, 0.05944903, 0.71811268]),
            np.array([0.50657673, 0.32827107, 0.77367329]),
            np.array([0.67794851, 0.0425902 , 0.79765397]),
            np.array([0.48502686, 0.57445648, 0.55215782]),
            np.array([0.4133027 , 0.68599076, 0.15554545]),
            np.array([0.64042845, 0.11637967, 0.46756321]),
            np.array([0.62490741, 0.07816275, 0.05361911]),
            np.array([0.69472941, 0.57802039, 0.33139409]),
            np.array([1.05635777, 0.2709248 , 0.03026843]),
            np.array([0.32230252, 0.03066249, 0.05329539]),
            np.array([0.75058153, 0.34064238, 0.48429545]),
            np.array([0.33889835, 0.15477747, 0.6950908 ]),
            np.array([0.87437107, 0.50971661, 0.24941165]),
            np.array([0.21939221, 1.0279108 , 0.08287706]),
            np.array([0.31570711, 0.06286902, 0.71206733]),
            np.array([0.45979423, 0.59539669, 0.6801963 ]),
            np.array([0.65418758, 0.73071749, 0.04796262]),
            np.array([0.65515363, 0.18722564, 0.6833174 ]),
            np.array([0.02864305, 0.30851838, 0.87364112]),
            np.array([0.58255828, 0.70288273, 0.03974124]),
            np.array([0.1535357 , 0.56233714, 0.91484405]),
            np.array([0.3137341 , 0.38677694, 0.20023799]),
            np.array([0.87173525, 0.37505845, 0.00764547]),
            np.array([0.56636345, 0.39505166, 0.50045829]),
            np.array([0.27970893, 1.01068246, 0.04950343]),
            np.array([0.87448259, 0.58970617, 0.04935179]),
            np.array([0.28402821, 0.40228578, 0.31806717]),
            np.array([0.27247315, 0.26977359, 0.12161675]),
            np.array([0.18385442, 0.57882869, 0.58113168]),
            np.array([0.61027091, 0.08581275, 0.83872018]),
            np.array([0.38982244, 0.63706978, 0.48723686]),
            np.array([0.43550758, 0.35681273, 0.61047623]),
            np.array([0.11868919, 0.38017402, 0.48030924]),
            np.array([0.17122824, 0.62079281, 0.81840896]),
            np.array([0.09335997, 0.48054792, 0.77523159]),
            np.array([0.75918624, 0.17978149, 0.00874249]),
            np.array([0.37810126, 0.75213724, 0.60044824]),
            np.array([0.70570748, 0.77168736, 0.27077333]),
            np.array([0.14443577, 0.88473475, 0.60187462]),
            np.array([0.81450688, 0.60581666, 0.15809067]),
            np.array([0.1479174 , 0.59236695, 0.454276  ]),
            np.array([0.86360807, 0.58125211, 0.19894549]),
            np.array([0.33712733, 0.2060519 , 0.63382552]),
            np.array([0.85479489, 0.47301101, 0.1794466 ]),
            np.array([0.06289833, 0.59065249, 0.00646191]),
            np.array([0.04769619, 0.26915204, 0.04594723]),
            np.array([0.76798227, 0.38105487, 0.52339437]),
            np.array([0.55240124, 0.91995874, 0.2170064 ]),
            np.array([0.36294857, 0.25920579, 0.80411569]),
            np.array([0.75005544, 0.3898593 , 0.50581892]),
            np.array([0.18582997, 0.13062453, 0.53882563]),
            np.array([0.8428691 , 0.6383752 , 0.23496268]),
            np.array([0.60327612, 0.26469889, 0.68782324]),
            np.array([0.74176617, 0.73927367, 0.28792778]),
            np.array([0.17546345, 0.20483974, 0.25456207]),
            np.array([0.66691185, 0.08658603, 0.39639171]),
            np.array([0.63815366, 0.69649931, 0.31503411]),
            np.array([0.28597246, 0.40753437, 0.79324874]),
            np.array([0.56284548, 0.66894059, 0.06161759]),
            np.array([0.41774815, 1.01130963, 0.03681965]),
            np.array([0.59944758, 0.16684703, 0.18351788]),
            np.array([0.50318229, 0.89301353, 0.0852893 ]),
            np.array([0.71855663, 0.0042067 , 0.48063133]),
            np.array([0.14651115, 0.26447009, 0.68554167]),
            np.array([0.1726972 , 0.88395738, 0.51149064]),
            np.array([0.41671532, 0.52921325, 0.02614592]),
            np.array([0.49879033, 0.43692417, 0.68462942]),
            np.array([0.26100647, 0.23871712, 0.87047299]),
            np.array([0.40780316, 0.85596182, 0.02898296]),
            np.array([0.22888002, 0.76484316, 0.31409819]),
            np.array([0.46392446, 0.96119123, 0.11385772]),
            np.array([0.91963433, 0.09911146, 0.4856595 ]),
            np.array([0.37048251, 0.11760599, 0.82466362]),
            np.array([0.32492622, 0.85240424, 0.19150415]),
            np.array([0.52489784, 0.60184005, 0.67842197]),
            np.array([0.2356886 , 0.65291186, 0.46115249]),
            np.array([0.46906933, 0.50443979, 0.36009005]),
            np.array([0.28214192, 0.22258837, 0.32775266]),
            np.array([0.25629504, 0.48597625, 0.3133556 ]),
            np.array([0.81442245, 0.0044474 , 0.304985  ]),
            np.array([0.82356354, 0.70609777, 0.16097634]),
            np.array([0.2312076 , 0.05104411, 0.20182606]),
            np.array([0.02455418, 0.33840867, 0.94929068]),
            np.array([0.6064126 , 0.51196768, 0.68774706]),
            np.array([0.37025694, 0.58460262, 0.79698042]),
            np.array([0.6630217 , 0.58271957, 0.09679542]),
            np.array([0.17498099, 0.19225113, 0.62008605]),
            np.array([0.53638526, 0.27324861, 0.37962415]),
            np.array([0.50579211, 0.07063959, 0.08103755]),
            np.array([0.33954587, 0.54123148, 0.84760221]),
            np.array([0.23143268, 0.73765752, 0.44732588]),
            np.array([0.70844638, 0.29248122, 0.20817968]),
            np.array([0.62544651, 0.56899907, 0.57602101]),
            np.array([0.96804217, 0.30647141, 0.31287735]),
            np.array([0.39778334, 0.48655861, 0.38714482]),
            np.array([0.16737659, 0.85109255, 0.03767355]),
            np.array([0.20825655, 0.54731413, 0.21908227]),
            np.array([1.04278838, 0.28165883, 0.04899547]),
            np.array([0.18934451, 0.42342707, 0.5534863 ]),
            np.array([0.76847053, 0.50893365, 0.24482788]),
            np.array([0.98780386, 0.20062533, 0.43498806]),
            np.array([0.98644813, 0.44002024, 0.18068546]),
            np.array([0.71310344, 0.28783569, 0.41860197]),
            np.array([0.1994464 , 1.01979639, 0.05776888]),
            np.array([0.26039073, 0.52178428, 0.46498496]),
            np.array([0.68825807, 0.64343035, 0.04222752]),
            np.array([0.57002564, 0.74124685, 0.12522906]),
            np.array([0.54625331, 0.23904283, 0.24453629]),
            np.array([0.19600689, 0.81163833, 0.66252707]),
            np.array([0.6237049 , 0.34329239, 0.21114596]),
            np.array([0.3400495 , 0.28954798, 0.52884357]),
            np.array([0.96367651, 0.4725961 , 0.23729786]),
            np.array([0.64790462, 0.38159002, 0.35065554]),
            np.array([0.72399658, 0.65282551, 0.47460005]),
            np.array([0.96500827, 0.28926472, 0.37386262]),
            np.array([0.30962839, 0.03293487, 0.46395507]),
            np.array([0.60488384, 0.23545868, 0.01315723]),
            np.array([0.00261337, 0.41513654, 0.84004601]),
            np.array([0.94259588, 0.52892945, 0.20211771]),
            np.array([0.31315602, 0.11493886, 0.44856067]),
            np.array([0.40310484, 0.386947  , 0.4124005 ]),
            np.array([0.61155506, 0.26066231, 0.32254078]),
            np.array([0.79386308, 0.55987354, 0.30372431]),
            np.array([0.42581701, 0.93143023, 0.32404426]),
            np.array([0.5354178 , 0.62303709, 0.58865099]),
            np.array([0.37327755, 0.74635528, 0.54024906]),
            np.array([0.42113101, 0.05068468, 0.08652672]),
            np.array([0.72905342, 0.67094494, 0.2485962 ]),
            np.array([0.81166114, 0.11519105, 0.51541104]),
            np.array([0.36695222, 0.50175474, 0.87875812]),
            np.array([0.99302158, 0.44794653, 0.15111727]),
            np.array([0.13122417, 0.05038683, 0.18875837]),
            np.array([0.16583975, 0.53951555, 0.46127601]),
            np.array([0.67076213, 0.59451269, 0.37878999]),
            np.array([0.54644717, 0.27616073, 0.88193512]),
            np.array([0.56272488, 0.4302011 , 0.20489658]),
            np.array([0.1747642 , 0.26807325, 0.10752018]),
            np.array([0.45319925, 0.8539065 , 0.34926719]),
            np.array([0.04955439, 0.61933384, 0.42248195]),
            np.array([0.15028697, 0.49653926, 0.19317881]),
            np.array([0.13497079, 0.27934641, 1.04542518]),
            np.array([0.16126977, 0.49071463, 0.57098942]),
            np.array([0.64918395, 0.67508168, 0.2059351 ])
        ])


    def run(self, consider_middle_point=False):
        print("\nTester::run")
        for model in self.MODELS:
            rk = RobotKinematics(model)
            df = self.df
            for i in range(self.NPOINTS):
                main_point = self.point_collection[model].loc[i]
                # print("Reaching ", main_point)
                start = time.time()
                sol = rk.run_trac_ik(main_point)
                end = time.time()
                # print("Solution: ", sol)
                if sol is not None:
                    inferred_main_point = rk.angle_to_positions(sol)[-1]
                else:
                    inferred_main_point = np.array([0,0,0])
                # errore percentuale
                main_point_error = np.linalg.norm(main_point - inferred_main_point)*100/np.linalg.norm(main_point)
                # save result
                df.loc[len(df)] = [ model, "trac-ik", main_point, inferred_main_point, main_point_error, "", -1, (end-start) ]
                print(".", end="", flush=True)
        print()

    def write_to_files(self):
        self.df.to_csv("df_latest_tracik.csv")
        print("Wrote correctly to file")


if __name__ == '__main__':
    try:
        rospy.init_node('ros_snake', anonymous=True)
        rate = rospy.Rate(1)
        print(os.getcwd())
        tester = Tester()
        tester.run(consider_middle_point=False)
        tester.write_to_files()
    except rospy.ROSInterruptException:
        pass